---
title: Glitch
published_at: 2024-04-02
snippet: the aesthetics of cybernetic faux-pas
disable_html_sanitization: true
---

<div text-align="center">
  <canvas id="glitch_test"></canvas>
</div>

<script type="module">
  const cnv = document.getElementById (`glitch_test`)
  cnv.width = cnv.parentNode.scrollWidth
  cnv.height = cnv.width * 9 / 16
  cnv.style.backgroundColor = `tomato`

  const ctx = cnv.getContext (`2d`)

  cnv.ondrop = e => {
    const reader = new FileReader ()

    reader.onload = d => {
      const new_div = document.createElement (`div`)
      new_div.innerText = d.target.result
      new_div.style.fontFamily = `monospace`
      new_div.style.wordBreak = `break-all`
      new_div.style.position = `absolute`
      new_div.style.top = 0
      new_div.style.left = 0
      new_div.style.zIndex = -1
      new_div.style.color = `grey`
      document.body.append (new_div)

      const img = new Image ()
      img.onload = e => {
        const ar = img.height / img.width
        cnv.height = cnv.width * ar
        ctx.drawImage (img, 0, 0, cnv.width, cnv.height)

      }

      const b = d.target.result
      const chunk_size = 128
      const rand_i = Math.floor (Math.random () * (b.length - chunk_size))
      const front = b.slice (0, rand_i)
      const back = b.slice (rand_i + chunk_size, b.length)

      img.src = front + back //.splice (Math.random () * b.length, 12)
    }

    ;[ ... e.dataTransfer.files ].forEach ((f, i) => {
      reader.readAsDataURL (f);
    })

    e.preventDefault ()
  }

  cnv.ondragover = e => {
    e.preventDefault ()
  }
</script>
